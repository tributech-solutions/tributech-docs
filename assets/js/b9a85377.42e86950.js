"use strict";(self.webpackChunktributech_docs=self.webpackChunktributech_docs||[]).push([[8741],{93548:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return c},default:function(){return g},frontMatter:function(){return u},metadata:function(){return l},toc:function(){return m}});var o=n(83117),a=n(80102),r=(n(67294),n(3905)),i=n(36110),s=["components"],u={title:"MQTT Source",sidebar_position:4},c=void 0,l={unversionedId:"setup/agent/sources/mqtt",id:"setup/agent/sources/mqtt",title:"MQTT Source",description:"The MQTT Source allows you to publish to a custom MQTT Topic which will be forwarded to a Stream via our Edge Agent.",source:"@site/docs/setup/agent/sources/mqtt.mdx",sourceDirName:"setup/agent/sources",slug:"/setup/agent/sources/mqtt",permalink:"/next/setup/agent/sources/mqtt",draft:!1,editUrl:"https://github.com/tributech-solutions/tributech-dsk-docs/edit/master/docs/setup/agent/sources/mqtt.mdx",tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"MQTT Source",sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Simulated Source",permalink:"/next/setup/agent/sources/simulated"},next:{title:"Tributech Agent Companion",permalink:"/next/setup/agent_companion"}},p={},m=[{value:"Manual setup",id:"manual-setup",level:2}],d={toc:m};function g(e){var t=e.components,u=(0,a.Z)(e,s);return(0,r.kt)("wrapper",(0,o.Z)({},d,u,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The MQTT Source allows you to publish to a custom MQTT Topic which will be forwarded to a Stream via our Edge Agent. "),(0,r.kt)("h2",{id:"manual-setup"},"Manual setup"),(0,r.kt)("p",null,"For the manual setup of the Tributech MQTT Source (",(0,r.kt)("inlineCode",{parentName:"p"},"mqtt-source"),") we need the main ",(0,r.kt)("a",{parentName:"p",href:"../docker-compose#agent-manual-setup"},(0,r.kt)("strong",{parentName:"a"},"DSK Edge services"))," as a basis."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Copy the ",(0,r.kt)("a",{target:"_blank",href:n(59371).Z},(0,r.kt)("code",null,"docker-compose.override.yml"))," file.\n(see also ",(0,r.kt)("a",{parentName:"p",href:"https://docs.docker.com/compose/extends/#understanding-multiple-compose-files"},(0,r.kt)("strong",{parentName:"a"},"Docker doc - Understanding multiple Compose files")),")"),(0,r.kt)(i.Z,{className:"language-yml",title:"docker-compose.override.yml",mdxType:"CodeBlock"},'version: "3.3"\n\nservices:\n  mqtt-source:\n    image: ${DOCKER_REGISTRY-tributech.azurecr.io/}mqtt-source:${SOURCE_TAG:-latest}\n    depends_on:\n      - mosquitto-server\n      - dsk-agent\n    environment:\n      - MqttOptions__MQTTHost=mosquitto-server\n      - Logging__LogLevel__Default=Information\n      # push logs to Loki at server via promtail\n      - TelemetryOptions__LokiUrl=https://promtail-push.${NODE_NAME:?"The variable NODE_NAME needs to be configured in the .env file."}.dataspace-node.com\n      - TelemetryOptions__LokiUser=tributech\n      - TelemetryOptions__LokiPassword=${LOKI_PROMTAIL_PW:?"The variable LOKI_PROMTAIL_PW needs to be configured in the .env file."}\n      - TelemetryOptions__ServiceName=${AGENT_NAME:?"The variable AGENT_NAME needs to be configured in the .env file."}-ads-source\n      - TelemetryOptions__ServiceId=${AGENT_ID:?"The variable AGENT_ID needs to be configured in the .env file."}\n    networks:\n      - edge-net\n    restart: unless-stopped\n    logging:\n      driver: "json-file"\n      options:\n        max-size: "2m"\n        max-file: "5"\n')),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Startup all Tributech Edge and MQTT service (will automatically retrieve the Docker images)."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker-compose up -d\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Configure the MQTT Source via our DTDL Model and setup your custom Topics")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"You can now continue with ",(0,r.kt)("a",{parentName:"p",href:"/next/setup/agent_companion#agent-companion-connect"},(0,r.kt)("strong",{parentName:"a"},"connecting to, linking & configuring"))," the DSK Edge Agent and the ",(0,r.kt)("a",{parentName:"p",href:"/next/provide_data/iot/mqtt"},(0,r.kt)("strong",{parentName:"a"},"MQTT Source")),"."))))}g.isMDXComponent=!0},59371:function(e,t,n){t.Z=n.p+"assets/files/docker-compose.override-a5b0d02a5cf6236cdea59a6892705109.yml"}}]);